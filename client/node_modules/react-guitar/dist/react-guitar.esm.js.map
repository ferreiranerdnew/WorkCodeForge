{"version":3,"file":"react-guitar.esm.js","sources":["../src/hooks/layoutEffect.ts","../src/util/arrays.ts","../src/util/theme.ts","../src/styles/index.ts","../src/index.tsx"],"sourcesContent":["import { useEffect, useLayoutEffect } from 'react'\n\nexport default typeof window !== 'undefined' ? useLayoutEffect : useEffect\n","export function set<T>(array: T[], pos: number, item: T): T[] {\n  const newArray = array.slice(0)\n  newArray[pos] = item\n  return newArray\n}\n","export type Theme = {\n  description: string\n  color: string\n  nut: { color: string }\n  fret: {\n    color: string\n    separator: {\n      color: string\n      radius?: boolean\n      shadow?: boolean\n      width?: 'sm' | 'md'\n    }\n    marker?: (fret: number) => JSX.Element | null\n    counter: { color: string }\n  }\n  string: { color: (string: number) => string }\n  finger: { text: { color: string }; color: string }\n}\nconst makeTheme = (theme: Theme) => theme\n\nexport default makeTheme({\n  description:\n    'A typical Spanish guitar with a brown fretboard and golden details',\n  color: '#333333',\n  nut: { color: '#fffacd' },\n  fret: {\n    color: '#9e6429',\n    separator: { color: '#daa520', shadow: true },\n    counter: { color: '#606c76' },\n  },\n  string: { color: () => '#eeeeee' },\n  finger: { text: { color: '#606c76' }, color: 'white' },\n})\n","import { css } from '@emotion/react'\nimport { Theme } from '..'\nimport color from 'color'\n\nconst sw = (theme: Theme) => (theme.fret.separator.width === 'md' ? 0.7 : 0.3)\nconst stringHeight = 3.33125\n\nexport default (theme: Theme) =>\n  css({\n    fontFamily: \"'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif\",\n    position: 'relative',\n    boxSizing: 'border-box',\n    maxWidth: '100%',\n    overflowY: 'auto',\n    borderTopColor: theme.color,\n    borderTopStyle: 'solid',\n    borderTopWidth: '0.5em',\n    overscrollBehaviorX: 'none',\n\n    '&.lefty': {\n      direction: 'rtl',\n      '.marker': {\n        transform: 'scale(-1, 1)',\n      },\n      '.mute': {\n        left: 'auto',\n        right: 0,\n      },\n    },\n\n    '*, *::before, *::after': {\n      boxSizing: 'border-box',\n    },\n\n    '.frets': {\n      display: 'flex',\n      position: 'relative',\n      '.fret': {\n        width: '10em',\n        flexShrink: 0,\n        position: 'relative',\n        '&.nut,&.mute': {\n          width: '7em',\n        },\n        '&.mute': {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n        },\n      },\n    },\n\n    '.frame': {\n      height: '2em',\n      '.counter': {\n        fontWeight: 'bold',\n        color: theme.fret.counter.color,\n      },\n      '.fret': {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: theme.color,\n      },\n    },\n\n    '.strings': {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      position: 'relative',\n      minHeight: `${stringHeight * 3}em`,\n\n      '.string': {\n        margin: 0,\n        padding: 0,\n        border: 'none',\n        '.fret': {\n          display: 'flex',\n          alignItems: 'center',\n\n          '.actual-string': {\n            transition: 'opacity ease-in-out 0.1s',\n            content: '\"\"',\n            width: '100%',\n            height: '0.65em',\n            position: 'absolute',\n            left: '0',\n          },\n\n          label: {\n            fontSize: '1em',\n            width: '100%',\n            height: `${stringHeight}em`,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            margin: 0,\n          },\n\n          '&:hover input:not(:disabled):not(:checked) ~ .finger': {\n            opacity: 0.5,\n          },\n\n          'input:not(:disabled)': {\n            height: '100%',\n            width: '100%',\n          },\n\n          'input:not(:disabled),input:not(:disabled) ~ .finger': {\n            cursor: 'pointer',\n          },\n\n          input: {\n            position: 'absolute',\n            margin: 0,\n            opacity: 0,\n            '&:checked ~ .finger': {\n              opacity: 1,\n            },\n            '&:focus:not(:disabled) ~ .finger': {\n              boxShadow: '0 0 0 0.2em rgba(66, 153, 225, 0.5)',\n            },\n          },\n          '&.mute': {\n            'input:checked ~ .finger': {\n              opacity: 0,\n            },\n            'input:focus ~ .finger,&:hover input:checked ~ .finger': {\n              opacity: 0.5,\n            },\n          },\n        },\n      },\n    },\n\n    '.fretboard': {\n      position: 'absolute',\n      left: '0',\n      right: '0',\n      top: '0',\n      bottom: '0',\n      '.fret': {\n        display: 'flex',\n        flexDirection: 'row-reverse',\n        alignItems: 'center',\n        justifyContent: 'end',\n        backgroundColor: theme.fret.color,\n        '&.nut': {\n          backgroundColor: theme.nut.color,\n        },\n        '&:not(.nut)::before': {\n          content: '\"\"',\n          position: 'absolute',\n          top: '0',\n          bottom: '0',\n          width: `${sw(theme)}em`,\n          backgroundColor: theme.fret.separator.color,\n          borderRight: theme.fret.separator.shadow\n            ? `solid ${sw(theme) / 2}em ${color(\n                theme.fret.separator.color\n              ).darken(0.1)}`\n            : 0,\n          borderRadius: theme.fret.separator.radius ? '3px' : 0,\n          display: 'inline-block',\n        },\n        '.marker': {\n          position: 'absolute',\n          left: '0',\n          right: '0',\n          top: '0',\n          bottom: '0',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        },\n      },\n    },\n\n    '.finger': {\n      color: theme.finger.text.color,\n      transition: 'opacity ease-in-out 0.1s',\n      background: theme.finger.color,\n      width: '5em',\n      padding: '0',\n      height: `${3.5 / 1.5}em`,\n      borderRadius: '20px',\n      borderBottom: `solid 0.2em ${color(theme.finger.color).darken(0.35)}`,\n      boxShadow: '0 1px 2px rgba(0, 0, 0, 0.16), 0 1px 2px rgba(0, 0, 0, 0.23)',\n      fontWeight: 'bold',\n      opacity: 0,\n      display: 'inline-flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      position: 'relative',\n    },\n\n    '.sr-only': {\n      position: 'absolute',\n      width: '1px',\n      height: '1px',\n      padding: 0,\n      margin: '-1px',\n      overflow: 'hidden',\n      clip: 'rect(0, 0, 0, 0)',\n      whiteSpace: 'nowrap',\n      borderWidth: 0,\n    },\n  })\n","/** @jsx jsx */\nimport { jsx } from '@emotion/react'\nimport { useRef, Fragment, useMemo, ReactElement, useState } from 'react'\nimport useLayoutEffect from './hooks/layoutEffect'\nimport range from 'lodash.range'\nimport uniqueId from 'lodash.uniqueid'\nimport { set } from './util/arrays'\nimport classNames from 'classnames'\nimport { get, fromMidiSharps } from '@tonaljs/note'\nimport { fromSemitones } from '@tonaljs/interval'\nimport spanishTheme, { Theme } from './util/theme'\nimport getStyles from './styles'\nimport color from 'color'\nimport { getKey } from 'keyboard-key'\n\nexport { spanishTheme, Theme }\n\nexport function getRenderFingerSpn(tuning: number[]) {\n  return (string: number, fret: number) => {\n    const { letter, acc, oct } = get(fromMidiSharps(tuning[string] + fret))\n    return (\n      <span>\n        {letter}\n        {acc === '#' ? '♯' : acc === 'b' ? '♭' : ''}\n        <sub aria-label={`octave ${oct}`}>{oct}</sub>\n      </span>\n    )\n  }\n}\n\nconst mod = (n: number, m: number) => (m + (n % m)) % m\n\nexport function getRenderFingerRelative(tuning: number[], root: number) {\n  return (string: number, fret: number) => (\n    <Fragment>\n      {range(12).map(fromSemitones)[mod(tuning[string] + fret - root, 12)]}\n    </Fragment>\n  )\n}\n\nfunction Frets(props: {\n  className?: string\n  currentFret?: number\n  frets: {\n    from: number\n    amount: number\n  }\n  children?: (fret: number) => ReactElement | ReactElement[] | null\n  onMouseEnter?: () => void\n}) {\n  const { from, amount } = props.frets\n  return (\n    <div\n      className={classNames(props.className, 'frets')}\n      onMouseEnter={props.onMouseEnter}\n    >\n      {props.currentFret !== undefined && (\n        <div\n          className=\"fret mute\"\n          style={{ zIndex: props.currentFret === -1 ? 1 : undefined }}\n        >\n          {props.children?.(-1)}\n        </div>\n      )}\n      {range(from, from + amount + 1).map((fret) => (\n        <div className={classNames('fret', { nut: fret === 0 })} key={fret}>\n          {props.children?.(fret)}\n        </div>\n      ))}\n    </div>\n  )\n}\n\nexport default function Guitar(props: {\n  id?: string\n  className?: string\n  strings?: number[]\n  frets?: {\n    from: number\n    amount: number\n  }\n  lefty?: boolean\n  center?: boolean\n  renderFinger?: (string: number, fret: number) => JSX.Element\n  theme?: Theme\n  playOnHover?: boolean\n  onChange?: (strings: number[]) => void\n  onPlay?: (string: number) => void\n}) {\n  const {\n    strings = [],\n    frets = { from: 0, amount: 22 },\n    lefty = false,\n    center = false,\n    renderFinger,\n    theme = spanishTheme,\n    playOnHover,\n  } = props\n  const id = useMemo(() => props.id || uniqueId('guitar-'), [props.id])\n  const styles = useMemo(() => getStyles(theme), [theme])\n  const ref = useRef(null as HTMLDivElement | null)\n  const focusString = (string: number, fret: number = strings[string]) =>\n    ref.current\n      ?.querySelector?.<HTMLInputElement>(\n        `input[name=\"${id}-string-${string}\"][value=\"${fret}\"]`\n      )\n      ?.focus()\n  const releaseString = (string: number) =>\n    pressString(string, strings[string] === 0 ? -1 : 0)\n  const pressString = (string: number, fret: number) => {\n    focusString(string, fret)\n    props.onChange?.(set(strings, string, fret))\n  }\n  const getNavigationDelta = (e: KeyboardEvent) => {\n    switch (getKey(e)) {\n      case 'ArrowDown':\n        return { x: 0, y: 1 }\n      case 'ArrowUp':\n        return { x: 0, y: -1 }\n      case 'ArrowRight':\n        return { x: lefty ? -1 : 1, y: 0 }\n      case 'ArrowLeft':\n        return { x: lefty ? 1 : -1, y: 0 }\n      default:\n        return null\n    }\n  }\n  useLayoutEffect(() => {\n    const fretsNode = ref.current\n    if (center && fretsNode) {\n      const children = fretsNode.querySelectorAll('.fret')\n      const pressedFrets = strings.filter((fret) => fret > 0)\n      const minFret = Math.min.apply(Math, pressedFrets)\n      const maxFret = Math.max.apply(Math, pressedFrets)\n      const toFret = minFret + Math.floor((maxFret - minFret) / 2)\n      const fretNode = children[toFret] as HTMLElement | undefined\n      if (fretNode) {\n        fretsNode.scrollLeft =\n          fretNode.offsetLeft -\n          fretsNode.offsetWidth / 2 +\n          fretNode.offsetWidth / 2\n      }\n    }\n  }, [ref, strings, center, lefty])\n  const [focusedString, setFocusedString] = useState(0)\n  return (\n    <div\n      id={id}\n      ref={ref}\n      css={styles}\n      className={classNames('guitar', { lefty }, props.className)}\n      onKeyDown={(e) => {\n        const delta = getNavigationDelta(e.nativeEvent)\n        if (delta) {\n          const string = mod(focusedString + delta.y, strings.length)\n          const fret = strings[string] + delta.x\n          pressString(\n            string,\n            fret > frets.from + frets.amount\n              ? -1\n              : fret < -1\n              ? frets.from + frets.amount\n              : fret\n          )\n          e.preventDefault()\n        }\n      }}\n    >\n      <div className=\"sr-only\">\n        This is a guitar with {strings.length} strings and {frets.amount} frets,\n        starting from {frets.from}. Its theme describes it as:{' '}\n        {theme.description}.\n        {props.onChange && (\n          <span>\n            Once you focus on a string you will be able to navigate strings and\n            frets using the arrow keys.\n          </span>\n        )}\n        {props.onPlay && (\n          <span>\n            When a specific string is focused you can play it by pressing 'p'.\n          </span>\n        )}\n      </div>\n      <div className=\"sr-only\" role=\"status\">\n        Current fretting: {strings.join(', ')}.\n      </div>\n      <div className=\"strings\">\n        <Frets className=\"fretboard\" frets={frets}>\n          {theme.fret.marker\n            ? (fret) => (\n                <div className=\"marker\">{theme.fret.marker?.(fret)}</div>\n              )\n            : undefined}\n        </Frets>\n        {strings.map((currentFret, string) => (\n          <fieldset key={string} className=\"string\">\n            <legend className=\"sr-only\">\n              String {string + 1}.{' '}\n              {currentFret === -1 && 'This string is muted.'}\n            </legend>\n            <Frets\n              currentFret={currentFret}\n              frets={frets}\n              onMouseEnter={() => playOnHover && props.onPlay?.(string)}\n            >\n              {(fret) => (\n                <label>\n                  <span className=\"sr-only\">\n                    Fret {fret} {fret === -1 && '(Mute)'}.\n                  </span>\n                  {fret >= 0 && (\n                    <span\n                      className=\"actual-string\"\n                      style={{\n                        opacity: currentFret === -1 ? 0.2 : 1,\n                        borderBottom: `solid 0.2em ${color(\n                          theme.string.color(string)\n                        ).darken(0.35)}`,\n                        backgroundColor: theme.string.color(string),\n                      }}\n                    />\n                  )}\n                  <input\n                    disabled={!props.onChange}\n                    type=\"radio\"\n                    name={`${id}-string-${string}`}\n                    value={fret}\n                    checked={currentFret === fret}\n                    onChange={(e) => {\n                      props.onChange?.(set(strings, string, fret))\n                      e.target.focus()\n                    }}\n                    onClick={() =>\n                      fret === currentFret && releaseString(string)\n                    }\n                    onKeyDown={(e) => {\n                      switch (e.keyCode) {\n                        case 80:\n                          props.onPlay?.(string)\n                          break\n                        case 13:\n                          releaseString(string)\n                          e.preventDefault()\n                      }\n                    }}\n                    onFocus={() => setFocusedString(string)}\n                  />\n                  <span className=\"finger\">\n                    {renderFinger?.(string, fret === -1 ? 0 : fret)}\n                  </span>\n                </label>\n              )}\n            </Frets>\n          </fieldset>\n        ))}\n      </div>\n      <Frets className=\"frame\" frets={frets}>\n        {(fret) =>\n          fret !== 0 ? <span className=\"counter\">{fret}</span> : null\n        }\n      </Frets>\n    </div>\n  )\n}\n"],"names":["window","useLayoutEffect","useEffect","set","array","pos","item","newArray","slice","makeTheme","theme","description","color","nut","fret","separator","shadow","counter","string","finger","text","sw","width","stringHeight","css","fontFamily","position","boxSizing","maxWidth","overflowY","borderTopColor","borderTopStyle","borderTopWidth","overscrollBehaviorX","direction","transform","left","right","display","flexShrink","top","height","fontWeight","alignItems","justifyContent","background","flexDirection","minHeight","margin","padding","border","transition","content","label","fontSize","opacity","cursor","input","boxShadow","bottom","backgroundColor","borderRight","darken","borderRadius","radius","borderBottom","overflow","clip","whiteSpace","borderWidth","getRenderFingerSpn","tuning","get","fromMidiSharps","letter","acc","oct","jsx","mod","n","m","getRenderFingerRelative","root","Fragment","range","map","fromSemitones","Frets","props","frets","from","amount","className","classNames","onMouseEnter","currentFret","undefined","style","zIndex","children","key","Guitar","strings","lefty","center","renderFinger","spanishTheme","playOnHover","id","useMemo","uniqueId","styles","getStyles","ref","useRef","focusString","current","querySelector","focus","releaseString","pressString","onChange","getNavigationDelta","e","getKey","x","y","fretsNode","querySelectorAll","pressedFrets","filter","minFret","Math","min","apply","maxFret","max","toFret","floor","fretNode","scrollLeft","offsetLeft","offsetWidth","useState","focusedString","setFocusedString","onKeyDown","delta","nativeEvent","length","preventDefault","onPlay","role","join","marker","disabled","type","name","value","checked","target","onClick","keyCode","onFocus"],"mappings":"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"}